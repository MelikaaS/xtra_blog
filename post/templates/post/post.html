{% extends 'base.html' %}
{% load static %}
{%  load render_partial %}

<!DOCTYPE html>
<html lang="en">

{% block content %}


    <div class="container-fluid">
    <main class="tm-main">
    <!-- Search form -->
    {% include 'includes/search_engine.html' %}


    <div class="row tm-row">
        <div class="col-12">
            <hr class="tm-hr-primary tm-mb-55">
            <!-- Video player 1422x800 -->
            <video width="954" height="535" controls class="tm-mb-40">
                <source src="{% static 'video/wheat-field.mp4' %}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
    </div>
    <div class="row tm-row">
        <div class="col-lg-8 tm-post-col">
            <div class="tm-post-full">

                <div class="mb-4">
                    <h2 class="pt-2 tm-color-primary tm-post-title">{{ item.title }}</h2>
                    <p class="tm-mb-40">{{ item.date }}{{ item.author }}</p>
                    <p>
                        This is a description of the video post. You can also have an image instead of
                        the video. You can free download
                        <a rel="nofollow" href="https://templatemo.com/tm-553-xtra-blog" target="_blank">Xtra Blog
                            Template</a>
                        from TemplateMo website. Phasellus maximus quis est sit amet maximus. Vestibulum vel rutrum
                        lorem, ac sodales augue. Aliquam erat volutpat. Duis lectus orci, blandit in arcu
                        est, elementum tincidunt lectus. Praesent vel justo tempor, varius lacus a,
                        pharetra lacus. </p>
                    <p>
                        {{ item.body }}
                    </p>
                    {% for cat in item.category.all %}
                        <span class="d-block text-right tm-color-primary">{{ cat }}</span>
                    {% endfor %}
                </div>


                <!-- Comments -->
                <div>
                    <h2 class="tm-color-primary tm-post-title">Comments</h2>
                    <hr class="tm-hr-primary tm-mb-45">
                    {% for cm in item.comments.all %}
                        {% if cm.parent == None %}

                            <div class="tm-comment tm-mb-45">
                                <figure class="tm-comment-figure">
                                    {% if cm.user.profile.image %}
                                        <img src="{{ cm.user.profile.image.url }}" alt="Image"
                                             class="mb-2 rounded-circle img-thumbnail">

                                    {% else %}
                                        <img src="{% static 'img/profile.png' %}" alt="Image"
                                             class="mb-2 rounded-circle img-thumbnail">

                                    {% endif %}
                                    <figcaption
                                            class="tm-color-primary text-center">{{ cm.user.get_full_name }}</figcaption>
                                </figure>
                                <div class="row">
                                    <div class="col-md-12">
                                        <p>
                                            {{ cm.text }}
                                        </p>
                                    </div>
                                    <div class="col-md-12">
                                        <span class="tm-color-primary">{{ cm.date }}</span>
                                        <div>
                                            <a href="#" onclick="set_value({{ cm.id }})" class="tm-color-primary">REPLY</a>
                                        </div>
                                    </div>

                                    <hr>

                                    {% for reply in cm.replies.all %}
                                        <div class="tm-comment-reply tm-mb-45">
                                            <hr>
                                            <div class="tm-comment">
                                                <figure class="tm-comment-figure">
                                                    <img src="img/comment-2.jpg" alt="Image"
                                                         class="mb-2 rounded-circle img-thumbnail">
                                                    <figcaption
                                                            class="tm-color-primary text-center">{{ reply.user.get_full_name }}</figcaption>
                                                </figure>
                                                <p>
                                                    {{ reply.text }}
                                                </p>
                                            </div>
                                            <span class="d-block text-right tm-color-primary">{{ reply.date }}</span>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}

                    {% if request.user.is_authenticated %}
                        <form action="" class="mb-5 tm-comment-form" method="post">
                            {% csrf_token %}
                            <h2 class="tm-color-primary tm-post-title mb-4">Your comment</h2>
                            <input type="number" id="parent_id" name="parent_id" value="">

                            <div class="mb-4">
                                <textarea id="body" class="form-control" name="text" rows="6"></textarea>
                            </div>
                            <div class="text-right">
                                <button class="tm-btn tm-btn-primary tm-btn-small">Submit</button>
                            </div>
                        </form>
                    {% else %}
                        <li><a href="{% url 'input:logform' %}" class="tm-color-primary">please login to add a
                            comment</a></li>
                    {% endif %}

                </div>
            </div>
        </div>
        {% include 'includes/sidebar.html' %}

    </div>
    <script>
        function set_value(id) {
            document.getElementById('parent_id').value=id;
            window.location.href="#parent_id"

        }
    </script>

{% endblock %}
</main>
</div>

